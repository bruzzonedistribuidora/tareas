<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Tareas - Bruzzone</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #f5f5f5;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --bg-hover: #e8e8e8;
            --text-primary: #1a1a2e;
            --text-secondary: #555566;
            --text-muted: #888899;
            --accent-blue: #2563eb;
            --accent-green: #16a34a;
            --accent-yellow: #ca8a04;
            --accent-red: #dc2626;
            --accent-purple: #7c3aed;
            --border-color: #d1d5db;
            --shadow: 0 4px 24px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.3s;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            margin-top: 1rem;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        /* Sync Status */
        .sync-status {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow);
            z-index: 100;
            transition: all 0.3s;
        }

        .sync-status.syncing {
            border-color: var(--accent-yellow);
        }

        .sync-status.synced {
            border-color: var(--accent-green);
        }

        .sync-status.error {
            border-color: var(--accent-red);
        }

        .sync-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-green);
        }

        .sync-status.syncing .sync-dot {
            background: var(--accent-yellow);
            animation: pulse 1s infinite;
        }

        .sync-status.error .sync-dot {
            background: var(--accent-red);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 1.5rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
        }

        .logo-text {
            font-weight: 700;
            font-size: 1.25rem;
        }

        .logo-text span {
            color: var(--text-secondary);
            font-weight: 400;
            font-size: 0.85rem;
            display: block;
        }

        .fecha-actual {
            font-family: 'Space Mono', monospace;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Main Layout */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 0.5rem;
        }

        .tab-btn {
            flex: 1;
            padding: 0.75rem 1.5rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 500;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: var(--bg-hover);
        }

        .tab-btn.active {
            background: var(--accent-blue);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Vista Lista (Original) */
        .lista-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 900px) {
            .lista-container {
                grid-template-columns: 1fr;
            }
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-blue);
            display: block;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.25rem;
        }

        .card-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .time-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }

        .btn {
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .categorias-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .categoria-item {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .categoria-item:hover {
            background: var(--bg-hover);
        }

        .categoria-item.active {
            background: var(--accent-blue);
            color: white;
        }

        .categoria-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .categoria-item:not(.active) .categoria-badge {
            background: var(--bg-hover);
            color: var(--text-secondary);
        }

        /* Filtros */
        .filtros {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .filtro-btn {
            padding: 0.6rem 1.2rem;
            border: 1px solid var(--border-color);
            background: var(--bg-card);
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filtro-btn:hover {
            background: var(--bg-hover);
        }

        .filtro-btn.active {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        .buscar-container {
            flex: 1;
            min-width: 250px;
        }

        .buscar-input {
            width: 100%;
            padding: 0.6rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        /* Tareas Cards */
        .tareas-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .tarea-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.25rem;
            display: flex;
            gap: 1rem;
            align-items: flex-start;
            transition: all 0.3s;
        }

        .tarea-card:hover {
            box-shadow: var(--shadow);
            transform: translateY(-2px);
        }

        .tarea-card.completada {
            opacity: 0.6;
        }

        .tarea-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            flex-shrink: 0;
            transition: all 0.3s;
        }

        .tarea-checkbox:hover {
            border-color: var(--accent-green);
        }

        .tarea-checkbox.checked {
            background: var(--accent-green);
            border-color: var(--accent-green);
            position: relative;
        }

        .tarea-checkbox.checked::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: 700;
        }

        .tarea-content {
            flex: 1;
        }

        .tarea-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin-bottom: 0.5rem;
        }

        .tarea-titulo {
            font-weight: 600;
            font-size: 1.05rem;
        }

        .tarea-card.completada .tarea-titulo {
            text-decoration: line-through;
        }

        .tarea-categoria, .tarea-prioridad {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .tarea-categoria.distribuidora { background: #dbeafe; color: #1e40af; }
        .tarea-categoria.ferreteria { background: #fef3c7; color: #92400e; }
        .tarea-categoria.desarrollo { background: #ddd6fe; color: #5b21b6; }
        .tarea-categoria.instagram { background: #fce7f3; color: #9f1239; }
        .tarea-categoria.personal { background: #d1fae5; color: #065f46; }

        .tarea-prioridad.alta { background: #fee2e2; color: #991b1b; }
        .tarea-prioridad.media { background: #fef3c7; color: #92400e; }
        .tarea-prioridad.baja { background: #d1fae5; color: #065f46; }

        .tarea-descripcion {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
        }

        .tarea-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .tarea-meta .vencida {
            color: var(--accent-red);
            font-weight: 600;
        }

        .tarea-meta .hoy {
            color: var(--accent-blue);
            font-weight: 600;
        }

        .tarea-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-action {
            width: 36px;
            height: 36px;
            border: 1px solid var(--border-color);
            background: var(--bg-card);
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .btn-action:hover {
            background: var(--bg-hover);
            transform: scale(1.1);
        }

        .btn-action.eliminar:hover {
            background: #fee2e2;
            border-color: var(--accent-red);
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        /* CRONOGRAMA */
        .cronograma-controls {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .cronograma-nav {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .nav-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            background: var(--bg-card);
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: var(--bg-hover);
        }

        .cronograma-fecha {
            font-size: 1.1rem;
            font-weight: 600;
            min-width: 250px;
            text-align: center;
        }

        .btn-hoy {
            padding: 0.5rem 1rem;
            border: 1px solid var(--accent-blue);
            background: var(--accent-blue);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-hoy:hover {
            background: #1d4ed8;
        }

        .vista-toggle {
            display: flex;
            gap: 0.5rem;
        }

        .vista-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            background: var(--bg-card);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .vista-btn:hover {
            background: var(--bg-hover);
        }

        .vista-btn.active {
            background: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }

        /* Vista Semanal */
        .calendario-semanal {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .calendario-header {
            display: grid;
            grid-template-columns: 80px repeat(7, 1fr);
            border-bottom: 2px solid var(--border-color);
        }

        .calendario-header-cell {
            padding: 1rem;
            text-align: center;
            font-weight: 600;
            border-right: 1px solid var(--border-color);
        }

        .calendario-header-cell:last-child {
            border-right: none;
        }

        .calendario-header-cell.hoy {
            background: var(--accent-blue);
            color: white;
        }

        .calendario-dia-nombre {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .calendario-dia-numero {
            font-size: 1.5rem;
            font-weight: 700;
            display: block;
        }

        .calendario-body {
            display: grid;
            grid-template-columns: 80px repeat(7, 1fr);
        }

        .calendario-horas {
            border-right: 1px solid var(--border-color);
        }

        .hora-cell {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border-color);
        }

        .calendario-columna {
            position: relative;
            border-right: 1px solid var(--border-color);
        }

        .calendario-columna:last-child {
            border-right: none;
        }

        .hora-slot {
            height: 60px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }

        .evento {
            position: absolute;
            left: 2px;
            right: 2px;
            background: var(--accent-blue);
            color: white;
            border-radius: 4px;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
        }

        .evento:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        .evento.distribuidora { background: #2563eb; }
        .evento.ferreteria { background: #ca8a04; }
        .evento.desarrollo { background: #7c3aed; }
        .evento.instagram { background: #db2777; }
        .evento.personal { background: #16a34a; }

        .evento-titulo {
            font-weight: 600;
            margin-bottom: 0.1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .evento-hora {
            font-size: 0.65rem;
            opacity: 0.9;
        }

        /* Vista Diaria */
        .calendario-diario {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .calendario-diario-header {
            display: grid;
            grid-template-columns: 80px 1fr;
            border-bottom: 2px solid var(--border-color);
            background: var(--accent-blue);
            color: white;
        }

        .calendario-diario-body {
            display: grid;
            grid-template-columns: 80px 1fr;
        }

        .evento-diario {
            background: var(--accent-blue);
            color: white;
            border-radius: 6px;
            padding: 0.75rem;
            margin: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .evento-diario:hover {
            transform: translateX(4px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .evento-diario.distribuidora { background: #2563eb; }
        .evento-diario.ferreteria { background: #ca8a04; }
        .evento-diario.desarrollo { background: #7c3aed; }
        .evento-diario.instagram { background: #db2777; }
        .evento-diario.personal { background: #16a34a; }

        .evento-diario-titulo {
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }

        .evento-diario-descripcion {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-bottom: 0.25rem;
        }

        .evento-diario-meta {
            font-size: 0.75rem;
            opacity: 0.8;
            display: flex;
            gap: 0.75rem;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 5rem;
            right: 1rem;
            background: var(--text-primary);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            transform: translateY(120px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        @media (max-width: 900px) {
            .calendario-header,
            .calendario-body {
                grid-template-columns: 60px repeat(7, 1fr);
            }

            .calendario-diario-header,
            .calendario-diario-body {
                grid-template-columns: 60px 1fr;
            }

            .hora-cell {
                font-size: 0.7rem;
                padding: 0.25rem;
            }

            .evento-titulo {
                font-size: 0.7rem;
            }

            .evento-hora {
                font-size: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner"></div>
        <p class="loading-text">Cargando datos...</p>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">B</div>
                <div class="logo-text">
                    Bruzzone
                    <span>Gestor de Tareas</span>
                </div>
            </div>
            <div id="fechaActual" class="fecha-actual"></div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Navegaci√≥n de Tabs -->
        <div class="tab-navigation">
            <button class="tab-btn active" onclick="cambiarTab('lista')">üìã Lista de Tareas</button>
            <button class="tab-btn" onclick="cambiarTab('cronograma')">üìÖ Cronograma</button>
        </div>

        <!-- TAB: Lista de Tareas -->
        <div id="tabLista" class="tab-content active">
            <div class="lista-container">
                <!-- Sidebar -->
                <div class="sidebar">
                    <!-- Estad√≠sticas -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span id="statPendientes" class="stat-number">0</span>
                            <span class="stat-label">Pendientes</span>
                        </div>
                        <div class="stat-card">
                            <span id="statUrgentes" class="stat-number">0</span>
                            <span class="stat-label">Urgentes</span>
                        </div>
                        <div class="stat-card">
                            <span id="statCompletadas" class="stat-number">0</span>
                            <span class="stat-label">Completadas</span>
                        </div>
                        <div class="stat-card">
                            <span id="statTotal" class="stat-number">0</span>
                            <span class="stat-label">Total</span>
                        </div>
                    </div>

                    <!-- Nueva Tarea -->
                    <div class="card">
                        <h3 class="card-title">Nueva Tarea</h3>
                        <form id="formTarea" onsubmit="event.preventDefault(); agregarTarea();">
                            <div class="form-group">
                                <label class="form-label">T√≠tulo</label>
                                <input id="inputTitulo" type="text" class="form-input" placeholder="¬øQu√© hay que hacer?" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Descripci√≥n</label>
                                <textarea id="inputDescripcion" class="form-textarea" placeholder="Detalles..."></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Categor√≠a</label>
                                <select id="inputCategoria" class="form-select">
                                    <option value="distribuidora">üè¢ Distribuidora</option>
                                    <option value="ferreteria">üîß Ferreter√≠a</option>
                                    <option value="desarrollo">üíª Desarrollo</option>
                                    <option value="instagram">üì± Instagram</option>
                                    <option value="personal">üë§ Personal</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Prioridad</label>
                                <select id="inputPrioridad" class="form-select">
                                    <option value="alta">üî¥ Alta</option>
                                    <option value="media">üü° Media</option>
                                    <option value="baja">üü¢ Baja</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Fecha</label>
                                <input id="inputFecha" type="date" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Horario</label>
                                <div class="time-inputs">
                                    <input id="inputHoraInicio" type="time" class="form-input" placeholder="Inicio">
                                    <input id="inputHoraFin" type="time" class="form-input" placeholder="Fin">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">‚ûï Agregar Tarea</button>
                        </form>
                    </div>

                    <!-- Categor√≠as -->
                    <div class="card">
                        <h3 class="card-title">Categor√≠as</h3>
                        <div class="categorias-list">
                            <div class="categoria-item active" onclick="filtrarPorCategoria('todas')">
                                <span>üìÇ Todas</span>
                                <span id="countTodas" class="categoria-badge">0</span>
                            </div>
                            <div class="categoria-item" onclick="filtrarPorCategoria('distribuidora')">
                                <span>üè¢ Distribuidora</span>
                                <span id="countDistribuidora" class="categoria-badge">0</span>
                            </div>
                            <div class="categoria-item" onclick="filtrarPorCategoria('ferreteria')">
                                <span>üîß Ferreter√≠a</span>
                                <span id="countFerreteria" class="categoria-badge">0</span>
                            </div>
                            <div class="categoria-item" onclick="filtrarPorCategoria('desarrollo')">
                                <span>üíª Desarrollo</span>
                                <span id="countDesarrollo" class="categoria-badge">0</span>
                            </div>
                            <div class="categoria-item" onclick="filtrarPorCategoria('instagram')">
                                <span>üì± Instagram</span>
                                <span id="countInstagram" class="categoria-badge">0</span>
                            </div>
                            <div class="categoria-item" onclick="filtrarPorCategoria('personal')">
                                <span>üë§ Personal</span>
                                <span id="countPersonal" class="categoria-badge">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contenido Principal -->
                <div>
                    <!-- Filtros -->
                    <div class="filtros">
                        <button class="filtro-btn active" onclick="aplicarFiltro('todas')">Todas</button>
                        <button class="filtro-btn" onclick="aplicarFiltro('pendientes')">Pendientes</button>
                        <button class="filtro-btn" onclick="aplicarFiltro('completadas')">Completadas</button>
                        <button class="filtro-btn" onclick="aplicarFiltro('hoy')">Hoy</button>
                        <div class="buscar-container">
                            <input id="inputBuscar" type="text" class="buscar-input" placeholder="üîç Buscar tareas..." oninput="buscarTareas(this.value)">
                        </div>
                    </div>

                    <!-- Lista de Tareas -->
                    <div id="tareasList" class="tareas-list"></div>
                </div>
            </div>
        </div>

        <!-- TAB: Cronograma -->
        <div id="tabCronograma" class="tab-content">
            <!-- Controles del Cronograma -->
            <div class="cronograma-controls">
                <div class="cronograma-nav">
                    <button class="nav-btn" onclick="navegarCronograma(-1)">‚óÄ</button>
                    <div id="cronogramaFecha" class="cronograma-fecha"></div>
                    <button class="nav-btn" onclick="navegarCronograma(1)">‚ñ∂</button>
                </div>
                <button class="btn-hoy" onclick="irAHoy()">Hoy</button>
                <div class="vista-toggle">
                    <button class="vista-btn active" onclick="cambiarVistaCronograma('semanal')">Semana</button>
                    <button class="vista-btn" onclick="cambiarVistaCronograma('diario')">D√≠a</button>
                </div>
            </div>

            <!-- Vista Semanal -->
            <div id="vistaSemanal" class="calendario-semanal"></div>

            <!-- Vista Diaria -->
            <div id="vistaDiaria" class="calendario-diario" style="display: none;"></div>
        </div>
    </div>

    <!-- Sync Status -->
    <div id="syncStatus" class="sync-status synced">
        <div class="sync-dot"></div>
        <span id="syncText">Sincronizado</span>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        // ============================================
        // CONFIGURACI√ìN FIREBASE
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyA9x2C50mMRx5aWY5IfvUlZM97OApwm-IM",
            authDomain: "ferrecloud-8c3b4.firebaseapp.com",
            projectId: "ferrecloud-8c3b4",
            storageBucket: "ferrecloud-8c3b4.appspot.com",
            messagingSenderId: "785332165664",
            appId: "1:785332165664:web:47f7e77c82e2e7efb3a8c8"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ============================================
        // VARIABLES GLOBALES
        // ============================================
        let tareas = [];
        let categoriaActiva = 'todas';
        let filtroActivo = 'todas';
        let busqueda = '';
        let tabActual = 'lista';
        let vistaCronograma = 'semanal';
        let fechaCronograma = new Date();

        // ============================================
        // INICIALIZACI√ìN
        // ============================================
        window.addEventListener('DOMContentLoaded', () => {
            actualizarFecha();
            cargarTareas();
        });

        function cargarTareas() {
            db.collection('tareas').onSnapshot(snapshot => {
                tareas = [];
                snapshot.forEach(doc => {
                    tareas.push({ id: doc.id, ...doc.data() });
                });
                
                renderizarTareas();
                actualizarEstadisticas();
                actualizarContadores();
                
                if (tabActual === 'cronograma') {
                    renderizarCronograma();
                }

                setSyncStatus('synced', 'Sincronizado');
                
                setTimeout(() => {
                    document.getElementById('loadingOverlay').classList.add('hidden');
                }, 500);
            }, error => {
                console.error('Error cargando tareas:', error);
                setSyncStatus('error', 'Error de conexi√≥n');
                document.getElementById('loadingOverlay').classList.add('hidden');
            });
        }

        // ============================================
        // GESTI√ìN DE TABS
        // ============================================
        function cambiarTab(tab) {
            tabActual = tab;
            
            // Actualizar botones
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Mostrar contenido
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById('tab' + tab.charAt(0).toUpperCase() + tab.slice(1)).classList.add('active');
            
            if (tab === 'cronograma') {
                renderizarCronograma();
            }
        }

        // ============================================
        // CRUD TAREAS
        // ============================================
        async function agregarTarea() {
            const titulo = document.getElementById('inputTitulo').value.trim();
            if (!titulo) return;

            const btn = event.target.querySelector('button[type="submit"]');
            btn.disabled = true;
            setSyncStatus('syncing', 'Guardando...');

            const tarea = {
                titulo,
                descripcion: document.getElementById('inputDescripcion').value.trim(),
                categoria: document.getElementById('inputCategoria').value,
                prioridad: document.getElementById('inputPrioridad').value,
                fecha: document.getElementById('inputFecha').value,
                horaInicio: document.getElementById('inputHoraInicio').value,
                horaFin: document.getElementById('inputHoraFin').value,
                completada: false,
                fechaCreacion: firebase.firestore.FieldValue.serverTimestamp()
            };

            try {
                await db.collection('tareas').add(tarea);
                
                // Limpiar formulario
                document.getElementById('inputTitulo').value = '';
                document.getElementById('inputDescripcion').value = '';
                document.getElementById('inputFecha').value = '';
                document.getElementById('inputHoraInicio').value = '';
                document.getElementById('inputHoraFin').value = '';
                
                mostrarToast('‚úÖ Tarea agregada y sincronizada');
            } catch (error) {
                console.error('Error agregando tarea:', error);
                mostrarToast('‚ùå Error al guardar la tarea');
                setSyncStatus('error', 'Error al guardar');
            } finally {
                btn.disabled = false;
            }
        }

        async function toggleCompletada(id) {
            setSyncStatus('syncing', 'Sincronizando...');
            
            const tarea = tareas.find(t => t.id === id);
            if (tarea) {
                try {
                    await db.collection('tareas').doc(id).update({
                        completada: !tarea.completada
                    });
                    mostrarToast(tarea.completada ? '‚Ü©Ô∏è Tarea reabierta' : 'üéâ ¬°Tarea completada!');
                } catch (error) {
                    console.error('Error actualizando tarea:', error);
                    mostrarToast('‚ùå Error al actualizar');
                    setSyncStatus('error', 'Error');
                }
            }
        }

        async function eliminarTarea(id) {
            if (confirm('¬øEliminar esta tarea?')) {
                setSyncStatus('syncing', 'Eliminando...');
                
                try {
                    await db.collection('tareas').doc(id).delete();
                    mostrarToast('üóëÔ∏è Tarea eliminada');
                } catch (error) {
                    console.error('Error eliminando tarea:', error);
                    mostrarToast('‚ùå Error al eliminar');
                    setSyncStatus('error', 'Error');
                }
            }
        }

        // ============================================
        // FILTROS Y RENDERIZADO LISTA
        // ============================================
        function filtrarPorCategoria(categoria) {
            categoriaActiva = categoria;
            
            document.querySelectorAll('.categoria-item').forEach(item => item.classList.remove('active'));
            event.target.closest('.categoria-item').classList.add('active');
            
            renderizarTareas();
        }

        function aplicarFiltro(filtro) {
            filtroActivo = filtro;
            
            document.querySelectorAll('.filtro-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            renderizarTareas();
        }

        function buscarTareas(texto) {
            busqueda = texto.toLowerCase();
            renderizarTareas();
        }

        function filtrarTareas() {
            let resultado = [...tareas];

            if (categoriaActiva !== 'todas') {
                resultado = resultado.filter(t => t.categoria === categoriaActiva);
            }

            if (filtroActivo === 'pendientes') {
                resultado = resultado.filter(t => !t.completada);
            } else if (filtroActivo === 'completadas') {
                resultado = resultado.filter(t => t.completada);
            } else if (filtroActivo === 'hoy') {
                const hoy = new Date().toISOString().split('T')[0];
                resultado = resultado.filter(t => t.fecha === hoy);
            }

            if (busqueda) {
                resultado = resultado.filter(t => 
                    t.titulo.toLowerCase().includes(busqueda) ||
                    (t.descripcion && t.descripcion.toLowerCase().includes(busqueda))
                );
            }

            const prioridadOrden = { alta: 0, media: 1, baja: 2 };
            resultado.sort((a, b) => {
                if (a.completada !== b.completada) return a.completada ? 1 : -1;
                if (prioridadOrden[a.prioridad] !== prioridadOrden[b.prioridad]) {
                    return prioridadOrden[a.prioridad] - prioridadOrden[b.prioridad];
                }
                if (a.fecha && b.fecha) return new Date(a.fecha) - new Date(b.fecha);
                if (a.fecha) return -1;
                if (b.fecha) return 1;
                return 0;
            });

            return resultado;
        }

        function renderizarTareas() {
            const container = document.getElementById('tareasList');
            const tareasFiltradas = filtrarTareas();

            if (tareasFiltradas.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <p>No hay tareas para mostrar</p>
                    </div>
                `;
                return;
            }

            const hoy = new Date().toISOString().split('T')[0];
            const categoriaLabel = {
                distribuidora: 'Distribuidora',
                ferreteria: 'Ferreter√≠a',
                desarrollo: 'Desarrollo',
                instagram: 'Instagram',
                personal: 'Personal'
            };
            const prioridadLabel = {
                alta: 'üî¥ Alta',
                media: 'üü° Media',
                baja: 'üü¢ Baja'
            };

            container.innerHTML = tareasFiltradas.map(tarea => {
                let fechaClase = '';
                let fechaTexto = '';
                
                if (tarea.fecha) {
                    const fechaTarea = new Date(tarea.fecha + 'T00:00:00');
                    const hoyDate = new Date(hoy + 'T00:00:00');
                    
                    if (fechaTarea < hoyDate && !tarea.completada) {
                        fechaClase = 'vencida';
                        fechaTexto = '‚ö†Ô∏è Vencida';
                    } else if (tarea.fecha === hoy) {
                        fechaClase = 'hoy';
                        fechaTexto = 'üìÖ Hoy';
                    } else {
                        fechaTexto = 'üìÖ ' + fechaTarea.toLocaleDateString('es-AR', { day: '2-digit', month: '2-digit' });
                    }

                    if (tarea.horaInicio) {
                        fechaTexto += ` ${tarea.horaInicio}`;
                        if (tarea.horaFin) {
                            fechaTexto += ` - ${tarea.horaFin}`;
                        }
                    }
                }

                return `
                    <div class="tarea-card ${tarea.completada ? 'completada' : ''}">
                        <div class="tarea-checkbox ${tarea.completada ? 'checked' : ''}" onclick="toggleCompletada('${tarea.id}')"></div>
                        <div class="tarea-content">
                            <div class="tarea-header">
                                <span class="tarea-titulo">${tarea.titulo}</span>
                                <span class="tarea-categoria ${tarea.categoria}">${categoriaLabel[tarea.categoria]}</span>
                                <span class="tarea-prioridad ${tarea.prioridad}">${prioridadLabel[tarea.prioridad]}</span>
                            </div>
                            ${tarea.descripcion ? `<div class="tarea-descripcion">${tarea.descripcion}</div>` : ''}
                            <div class="tarea-meta">
                                ${fechaTexto ? `<span class="${fechaClase}">${fechaTexto}</span>` : ''}
                            </div>
                        </div>
                        <div class="tarea-actions">
                            <button class="btn-action eliminar" onclick="eliminarTarea('${tarea.id}')" title="Eliminar">üóëÔ∏è</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ============================================
        // CRONOGRAMA
        // ============================================
        function cambiarVistaCronograma(vista) {
            vistaCronograma = vista;
            
            document.querySelectorAll('.vista-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (vista === 'semanal') {
                document.getElementById('vistaSemanal').style.display = 'block';
                document.getElementById('vistaDiaria').style.display = 'none';
            } else {
                document.getElementById('vistaSemanal').style.display = 'none';
                document.getElementById('vistaDiaria').style.display = 'block';
            }
            
            renderizarCronograma();
        }

        function navegarCronograma(direccion) {
            if (vistaCronograma === 'semanal') {
                fechaCronograma.setDate(fechaCronograma.getDate() + (direccion * 7));
            } else {
                fechaCronograma.setDate(fechaCronograma.getDate() + direccion);
            }
            renderizarCronograma();
        }

        function irAHoy() {
            fechaCronograma = new Date();
            renderizarCronograma();
        }

        function renderizarCronograma() {
            if (vistaCronograma === 'semanal') {
                renderizarSemanal();
            } else {
                renderizarDiario();
            }
        }

        function renderizarSemanal() {
            const inicioSemana = new Date(fechaCronograma);
            inicioSemana.setDate(fechaCronograma.getDate() - fechaCronograma.getDay());
            
            // Actualizar t√≠tulo
            const finSemana = new Date(inicioSemana);
            finSemana.setDate(inicioSemana.getDate() + 6);
            document.getElementById('cronogramaFecha').textContent = 
                `${inicioSemana.toLocaleDateString('es-AR', { day: '2-digit', month: 'short' })} - ${finSemana.toLocaleDateString('es-AR', { day: '2-digit', month: 'short', year: 'numeric' })}`;

            const container = document.getElementById('vistaSemanal');
            const hoy = new Date().toISOString().split('T')[0];
            const dias = ['Dom', 'Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b'];
            
            // Header
            let headerHTML = '<div class="calendario-header"><div class="calendario-header-cell"></div>';
            for (let i = 0; i < 7; i++) {
                const dia = new Date(inicioSemana);
                dia.setDate(inicioSemana.getDate() + i);
                const estaHoy = dia.toISOString().split('T')[0] === hoy;
                
                headerHTML += `
                    <div class="calendario-header-cell ${estaHoy ? 'hoy' : ''}">
                        <div class="calendario-dia-nombre">${dias[dia.getDay()]}</div>
                        <div class="calendario-dia-numero">${dia.getDate()}</div>
                    </div>
                `;
            }
            headerHTML += '</div>';

            // Body
            let bodyHTML = '<div class="calendario-body"><div class="calendario-horas">';
            
            // Horas
            for (let hora = 6; hora <= 23; hora++) {
                bodyHTML += `<div class="hora-cell">${hora.toString().padStart(2, '0')}:00</div>`;
            }
            bodyHTML += '</div>';

            // Columnas de d√≠as
            for (let i = 0; i < 7; i++) {
                const dia = new Date(inicioSemana);
                dia.setDate(inicioSemana.getDate() + i);
                const fechaDia = dia.toISOString().split('T')[0];
                
                bodyHTML += '<div class="calendario-columna">';
                
                // Slots de horas
                for (let hora = 6; hora <= 23; hora++) {
                    bodyHTML += '<div class="hora-slot"></div>';
                }
                
                // Eventos
                const tareasDia = tareas.filter(t => t.fecha === fechaDia && t.horaInicio && !t.completada);
                tareasDia.forEach(tarea => {
                    const [horaInicio, minInicio] = tarea.horaInicio.split(':').map(Number);
                    const [horaFin, minFin] = tarea.horaFin ? tarea.horaFin.split(':').map(Number) : [horaInicio + 1, minInicio];
                    
                    const top = ((horaInicio - 6) * 60 + minInicio) * (60 / 60);
                    const duracion = ((horaFin - horaInicio) * 60 + (minFin - minInicio));
                    const height = Math.max(duracion * (60 / 60), 30);
                    
                    bodyHTML += `
                        <div class="evento ${tarea.categoria}" style="top: ${top}px; height: ${height}px;">
                            <div class="evento-titulo">${tarea.titulo}</div>
                            <div class="evento-hora">${tarea.horaInicio} - ${tarea.horaFin || ''}</div>
                        </div>
                    `;
                });
                
                bodyHTML += '</div>';
            }
            bodyHTML += '</div>';

            container.innerHTML = headerHTML + bodyHTML;
        }

        function renderizarDiario() {
            const dia = new Date(fechaCronograma);
            
            // Actualizar t√≠tulo
            document.getElementById('cronogramaFecha').textContent = 
                dia.toLocaleDateString('es-AR', { weekday: 'long', day: '2-digit', month: 'long', year: 'numeric' });

            const container = document.getElementById('vistaDiaria');
            const fechaDia = dia.toISOString().split('T')[0];
            
            // Header
            let html = `
                <div class="calendario-diario-header">
                    <div class="calendario-header-cell"></div>
                    <div class="calendario-header-cell">
                        <div class="calendario-dia-nombre">${dia.toLocaleDateString('es-AR', { weekday: 'long' })}</div>
                        <div class="calendario-dia-numero">${dia.getDate()}</div>
                    </div>
                </div>
            `;

            // Body
            html += '<div class="calendario-diario-body"><div class="calendario-horas">';
            
            // Horas
            for (let hora = 6; hora <= 23; hora++) {
                html += `<div class="hora-cell">${hora.toString().padStart(2, '0')}:00</div>`;
            }
            html += '</div><div class="calendario-columna">';

            // Slots
            for (let hora = 6; hora <= 23; hora++) {
                html += '<div class="hora-slot"></div>';
            }

            // Eventos
            const tareasDia = tareas.filter(t => t.fecha === fechaDia && !t.completada);
            tareasDia.sort((a, b) => {
                if (!a.horaInicio && !b.horaInicio) return 0;
                if (!a.horaInicio) return 1;
                if (!b.horaInicio) return -1;
                return a.horaInicio.localeCompare(b.horaInicio);
            });

            tareasDia.forEach(tarea => {
                let top, height;
                
                if (tarea.horaInicio) {
                    const [horaInicio, minInicio] = tarea.horaInicio.split(':').map(Number);
                    const [horaFin, minFin] = tarea.horaFin ? tarea.horaFin.split(':').map(Number) : [horaInicio + 1, minInicio];
                    
                    top = ((horaInicio - 6) * 60 + minInicio) * (60 / 60);
                    const duracion = ((horaFin - horaInicio) * 60 + (minFin - minInicio));
                    height = Math.max(duracion * (60 / 60), 50);
                } else {
                    top = 0;
                    height = 60;
                }
                
                const prioridadLabel = {
                    alta: 'üî¥ Alta',
                    media: 'üü° Media',
                    baja: 'üü¢ Baja'
                };

                html += `
                    <div class="evento-diario ${tarea.categoria}" style="position: absolute; top: ${top}px; height: ${height}px;">
                        <div class="evento-diario-titulo">${tarea.titulo}</div>
                        ${tarea.descripcion ? `<div class="evento-diario-descripcion">${tarea.descripcion}</div>` : ''}
                        <div class="evento-diario-meta">
                            ${tarea.horaInicio ? `<span>‚è∞ ${tarea.horaInicio}${tarea.horaFin ? ' - ' + tarea.horaFin : ''}</span>` : ''}
                            <span>${prioridadLabel[tarea.prioridad]}</span>
                        </div>
                    </div>
                `;
            });

            html += '</div></div>';
            container.innerHTML = html;
        }

        // ============================================
        // ESTAD√çSTICAS
        // ============================================
        function actualizarEstadisticas() {
            const pendientes = tareas.filter(t => !t.completada).length;
            const urgentes = tareas.filter(t => !t.completada && t.prioridad === 'alta').length;
            const completadas = tareas.filter(t => t.completada).length;

            document.getElementById('statPendientes').textContent = pendientes;
            document.getElementById('statUrgentes').textContent = urgentes;
            document.getElementById('statCompletadas').textContent = completadas;
            document.getElementById('statTotal').textContent = tareas.length;
        }

        function actualizarContadores() {
            const pendientes = tareas.filter(t => !t.completada);
            
            document.getElementById('countTodas').textContent = pendientes.length;
            document.getElementById('countDistribuidora').textContent = pendientes.filter(t => t.categoria === 'distribuidora').length;
            document.getElementById('countFerreteria').textContent = pendientes.filter(t => t.categoria === 'ferreteria').length;
            document.getElementById('countDesarrollo').textContent = pendientes.filter(t => t.categoria === 'desarrollo').length;
            document.getElementById('countInstagram').textContent = pendientes.filter(t => t.categoria === 'instagram').length;
            document.getElementById('countPersonal').textContent = pendientes.filter(t => t.categoria === 'personal').length;
        }

        // ============================================
        // UTILIDADES
        // ============================================
        function actualizarFecha() {
            const opciones = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const fecha = new Date().toLocaleDateString('es-AR', opciones);
            document.getElementById('fechaActual').textContent = fecha.charAt(0).toUpperCase() + fecha.slice(1);
        }

        function setSyncStatus(status, text) {
            const el = document.getElementById('syncStatus');
            const textEl = document.getElementById('syncText');
            el.className = 'sync-status ' + status;
            textEl.textContent = text;
        }

        function mostrarToast(mensaje) {
            const toast = document.getElementById('toast');
            toast.textContent = mensaje;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }
    </script>
</body>
</html>
